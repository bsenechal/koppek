'use strict';

/**
 * Module dependencies.
 */
var mongoose = require('mongoose'),
	Schema = mongoose.Schema,
	crypto = require('crypto');

/**
 * A Validation function for local strategy properties
 */
var validateLocalStrategyProperty = function(property) {
	return ((this.provider !== 'local' && !this.updated) || property.length);
};

/**
 * A Validation function for local strategy password
 */
var validateLocalStrategyPassword = function(password) {
	return (this.provider !== 'local' || (password && password.length > 6));
};

/**
 * User Schema
 */
var UserSchema = new Schema({
	firstName: {
		type: String,
		trim: true,
		default: '',
		validate: [validateLocalStrategyProperty, 'Please fill in your first name']
	},
	lastName: {
		type: String,
		trim: true,
		default: '',
		validate: [validateLocalStrategyProperty, 'Please fill in your last name']
	},
	displayName: {
		type: String,
		trim: true
	},
	email: {
		type: String,
		trim: true,
		default: '',
		validate: [validateLocalStrategyProperty, 'Please fill in your email'],
		match: [/.+\@.+\..+/, 'Please fill a valid email address']
	},
	username: {
		type: String,
		unique: 'testing error message',
		required: 'Please fill in a username',
		trim: true
	},
	password: {
		type: String,
		default: '',
		validate: [validateLocalStrategyPassword, 'Password should be longer']
	},
	salt: {
		type: String
	},
	provider: {
		type: String,
		required: 'Provider is required'
	},
	providerData: {},
	additionalProvidersData: {},
	roles: {
		type: [{
			type: String,
			enum: ['user', 'admin']
		}],
		default: ['user']
	},
	notifications: [{
		date: Date,
		content: String
	}],
    votes: [{
		date: Date,
		type: Schema.ObjectId
	}],
	updated: {
		type: Date
	},
	created: {
		type: Date,
		default: Date.now
	},
	/* For reset password */
	resetPasswordToken: {
		type: String
	},
	resetPasswordExpires: {
		type: Date
	},
   userPoints: {
     type: Number,
     default: 0,
     trim: true
   },
	userRole: {
		type: Number,
    	default: 0,
		trim: true
	},
    avatar: {
		type: String,
		trim: true,
		default: 'data:image/png;base64,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'
	},
});

/**
 * Hook a pre save method to hash the password
 */
UserSchema.pre('save', function(next) {
	if (this.password && this.password.length > 6) {
		this.salt = new Buffer(crypto.randomBytes(16).toString('base64'), 'base64');
		this.password = this.hashPassword(this.password);
	}

	next();
});

/**
 * Create instance method for hashing a password
 */
UserSchema.methods.hashPassword = function(password) {
	if (this.salt && password) {
		return crypto.pbkdf2Sync(password, this.salt, 10000, 64).toString('base64');
	} else {
		return password;
	}
};

/**
 * Create instance method for authenticating user
 */
UserSchema.methods.authenticate = function(password) {
	return this.password === this.hashPassword(password);
};

/**
 * Find possible not used username
 */
UserSchema.statics.findUniqueUsername = function(username, suffix, callback) {
	var _this = this;
	var possibleUsername = username + (suffix || '');

	_this.findOne({
		username: possibleUsername
	}, function(err, user) {
		if (!err) {
			if (!user) {
				callback(possibleUsername);
			} else {
				return _this.findUniqueUsername(username, (suffix || 0) + 1, callback);
			}
		} else {
			callback(null);
		}
	});
};

mongoose.model('User', UserSchema);