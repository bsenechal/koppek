<section data-ng-controller="DealsController" >
    <div layout="row" layout-sm="column">
        <!-- <div layout="column" flex style="height: {{windowHeight}}px; overflow: auto;"> -->
        <div layout="column" flex style="height: 800px; overflow: auto;">
                <md-content>
                  <md-whiteframe class="md-whiteframe-z1" layout layout-align="center center">
                            <form name="searchForm" data-ng-submit="dealSearch()">
                                <div layout="row" layout-sm="column" flex-gt-sm offset="3">
                                    <md-input-container class="md-accent" flex-gt-sm="20">
                                    <label>Quoi ?</label> <input data-ng-model="srchText"
                                        type="text"> </md-input-container>
                                    <md-select ng-model="srchOrder" placeholder="Trier par">
                                      <md-option value="date">date</md-option>
                                      <md-option value="promotion">promotion</md-option>
                                      <md-option value="success">success</md-option>
                                    </md-select>                                    
                                    <md-input-container flex-gt-sm="10"> <md-button
                                        class="md-raised md-primary" data-bg-action="submit()">Rechercher</md-button>
                                    </md-input-container>
                                </div>
                    </md-whiteframe>
                    <md-list data-ng-if="deals[0]._id"> <md-list-item class="md-3-line"
                        data-ng-repeat="deal in deals| filter:searchQuery track by deal._id">
                    
                    <md-whiteframe class="md-whiteframe-z2" layout="row" layout-padding layout-margin>

                        <div flex = "15">
                            <md-button data-ng-href="#!/deals/{{::deal._id}}">
                                <img
                                ng-src="https://koppekimages.s3-eu-west-1.amazonaws.com/deals/{{::deal.image}}" width = "100%" height="100%"
                                alt="{{::deal.title}}" />
                             </md-button>
                            <div align="center">
                                <md-button class="md-raised md-primary">{{::deal.initialPrice}} €</md-button>
                            </div>
                            <div align="center">
                                <del>{{::deal.salePrice}} €</del> (- {{::deal.reduction}}%)
                            </div>
                        </div>
                        <div flex = "70" layout-padding>
                            <h2>
                                <a
                                    data-ng-href="#!/deals/{{::deal._id}}">{{::deal.title}}</a>
                            </h2>
                            <div>
                                <span class="md-caption">{{::deal.created |
                                    date:'medium'}}</span> / <span>{{::deal.user.name}}</span>
                                <p>{{::deal.description |
                                    limitTo:300}}...</p>
                            </div>
                        </div>
                        <div flex = "10" layout-column>
                    <!--          <span data-ng-if="hasAuthorization(deal)">
                                <a class="btn" href="/#!/deals/{{deal._id}}/edit">
                                  <i class="glyphicon glyphicon-edit"></i>
                                </a>
                                <a class="btn" data-ng-click="remove(::deal);">
                                  <i class="glyphicon glyphicon-trash"></i>
                                </a>
                              </span>-->
                              <div align="center">
                       <md-button align="center" class="md-fab md-mini md-primary" aria-label="Vote plus" data-ng-click="::updateGradePlus(deal);">
                            <md-icon class="glyphicon glyphicon-thumbs-up"></md-icon>
                          </md-button>
                            </div>

                              <h2 class="md-headline" align="center">{{deal.grade}}</h2>
                              <div align="center">
                         <md-button class="md-fab md-mini md-warn" aria-label="Vote plus" data-ng-click="::updateGradeMinus(deal);">
                            <md-icon class="glyphicon glyphicon-thumbs-down"></md-icon>
                          </md-button>
                            </div>
                            <div align="center">
                              <a class="btn" data-ng-click="::updateAlert(deal);">
                                <i class="glyphicon glyphicon-exclamation-sign"></i>
                              </a>
                            </div>
                        </div>
                        </md-whiteframe>
                    </md-list-item> </md-list>
                
                    <pagination data-ng-if="resultIsByRadius" total-items="numberOfDeals" ng-model="currentPage" ng-change="dealsByRadius(currentPage)" items-per-page='20' max-size='5' class="pagination-sm" boundary-links="true" rotate="false" ></pagination>
                    <pagination data-ng-if="!resultIsByRadius" total-items="numberOfDeals" ng-model="currentPage" ng-change="queryAll(currentPage)" items-per-page='20' max-size='5' class="pagination-sm" boundary-links="true" rotate="false" ></pagination>
                </md-content>

            <!-- </div> -->

        </div>

        <div flex hide-sm>
       
  <md-whiteframe class="md-whiteframe-z1" layout layout-align="center center">
                <div layout="row" layout-sm="column" flex-gt-sm offset="5">
                    <md-input-container class="md-accent" flex-gt-sm="20">
                    <label>Où ?</label> <input id="pac-input"
                        type="text"> </md-input-container>
                    <div flex-gt-sm offset="1"></div>
                    <md-input-container class="md-accent" flex-gt-sm="30">
                    <label>Cercle de recherche</label> <md-slider
                        class="md-accent" flex-gt-sm="30" min="0" max="1000"
                        value="500" ng-init="srchDealRadius = 500"
                        ng-model="srchDealRadius" aria-label="srchDealRadius"
                        id="srchDealRadius-slider"> </md-slider> </md-input-container>
                    <div flex-gt-sm offset="1"></div>
                    <md-input-container flex-gt-sm="5"> <md-checkbox
                        ng-model="data.cb1" aria-label="Checkbox 1">Deal
                    web ?</md-checkbox> </md-input-container>
                    <div flex-gt-sm offset="1"></div>
<!--                     <md-input-container flex-gt-sm="5"> <md-button
                        class="md-raised md-primary" href="/#!/deals">Search</md-button>
                    </md-input-container>
 -->                </div>
    </md-whiteframe>

            <section data-ng-controller="MapsController"
                data-ng-init="Map()">
                <div map-canvas id="map-canvas" style="height: 800px;"></div>
            </section>
            <!--<div class=".col-md-2">
                <input ng-model="searchQuery">
            </div>-->
        </div>
</section>
